+++
date = '2025-07-07T10:16:33+08:00'
draft = true
title = '2025.07.07(Mon.)'
+++

æ¢³ç†äº†å·¥ä½œæ€è·¯ï¼Œè°ƒæ•´äº†é‡ç‚¹ï¼Œä¸æ˜¯è·Ÿç€äº§å“åé¢ï¼Œè€Œæ˜¯æœ‰æƒ³æ³•åšæŠ€æœ¯è¯¥åšçš„
<!--more-->

# å·¥ä½œï¼š
- ædemo!
  - æ€ä¹ˆæï¼Ÿ
    - æœ¬åœ°å…ˆå†™æ§åˆ¶æµè§ˆå™¨çš„è„šæœ¬ï¼Œèƒ½è¿è¡Œå
    - å»è…¾è®¯äº‘ä¸Šå»ºä¸ªdocker,Dockerfile
- è°ƒç ”ä¸šç•Œbrowser use çš„äººå·¥ä»‹å…¥ç¨‹åº¦
  - manus
    - å¯¹éœ€è¦çš„é—®é¢˜çš„æ–¹å¼æš‚åœæµç¨‹ç»™ç”¨æˆ·åˆ¤æ–­
- 
- ![img.png](img.png)
  - gemini
  - kimi
  - openai


```bash
1. è¿›å…¥https://www.xiaohongshu.com/explore
2. å…³æ‰ç™»å½•å¼¹çª—
3. è¿›å…¥ç¬¬ä¸€ä¸ªå¸–å­
4. æŠŠç¬¬ä¸€ä¸ªå¸–å­çš„å†…å®¹å¡ç‰‡é‡Œçš„ç¬¬ä¸€å¼ å›¾å’Œæ–‡å­—å†…å®¹æ‰’ä¸‹æ¥ï¼ˆå›¾ç‰‡è°ƒç”¨visionç†è§£åè½¬æˆæ–‡å­—ï¼‰ 
```

```bash
åœ¨æ²™ç®±é‡Œè·‘
ç¬¬ä¸€é˜¶æ®µï¼šä½¿ç”¨å›ºå®šçš„è„šæœ¬ï¼Œåœ¨æ²™ç®±é‡ŒæŠŠbrowseræµç¨‹ä¸²èµ·æ¥
ç¬¬äºŒé˜¶æ®µï¼šä½¿ç”¨hunyuanç»™å‡ºçš„è„šæœ¬ï¼Œåœ¨æ²™ç®±é‡ŒæŠŠbrowseræµç¨‹ä¸²èµ·æ¥
```



```python
import os
import base64
import time
from playwright.sync_api import sync_playwright, TimeoutError as PlaywrightTimeoutError
from openai import OpenAI
from dotenv import load_dotenv

# --- é…ç½® ---
# åŠ è½½ .env æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡ (OPENAI_API_KEY)
load_dotenv()

# åˆå§‹åŒ– OpenAI å®¢æˆ·ç«¯
# å¦‚æœä½ çš„ .env è®¾ç½®æ­£ç¡®ï¼Œè¿™é‡Œä¼šè‡ªåŠ¨è¯»å– OPENAI_API_KEY
try:
    client = OpenAI()
    # æ£€æŸ¥APIå¯†é’¥æ˜¯å¦è¢«åŠ è½½
    if not client.api_key:
        raise ValueError("OpenAI API key not found. Please check your .env file or environment variables.")
except Exception as e:
    print(f"Error initializing OpenAI client: {e}")
    print("è¯·ç¡®ä¿ä½ å·²ç»åˆ›å»ºäº† .env æ–‡ä»¶å¹¶åœ¨å…¶ä¸­è®¾ç½®äº† OPENAI_API_KEYã€‚")
    exit()

# --- Vision API å‡½æ•° ---
def describe_image_with_gpt4v(image_bytes: bytes) -> str:
    """
    ä½¿ç”¨ OpenAI Vision API (GPT-4o) æ¥æè¿°å›¾ç‰‡å†…å®¹ã€‚
    """
    print("ğŸ¤– è°ƒç”¨ Vision API åˆ†æå›¾ç‰‡...")
    try:
        # å°†å›¾ç‰‡å­—èŠ‚è½¬æ¢ä¸º Base64 ç¼–ç 
        base64_image = base64.b64encode(image_bytes).decode('utf-8')

        response = client.chat.completions.create(
            model="gpt-4o",  # æˆ–è€…ä½¿ç”¨ "gpt-4-turbo"
            messages=[
                {
                    "role": "user",
                    "content": [
                        {
                            "type": "text",
                            "text": "è¯·è¯¦ç»†æè¿°è¿™å¼ å›¾ç‰‡çš„å†…å®¹ï¼ŒåŒ…æ‹¬å›¾ç‰‡ä¸­çš„ç‰©ä½“ã€äººç‰©ã€åœºæ™¯ã€æ°›å›´ä»¥åŠå¯èƒ½ä¼ è¾¾çš„ä¿¡æ¯ã€‚"
                        },
                        {
                            "type": "image_url",
                            "image_url": {
                                "url": f"data:image/png;base64,{base64_image}"
                            }
                        }
                    ]
                }
            ],
            max_tokens=500
        )
        description = response.choices[0].message.content
        print("âœ… å›¾ç‰‡åˆ†æå®Œæˆï¼")
        return description
    except Exception as e:
        print(f"è°ƒç”¨ OpenAI API æ—¶å‡ºé”™: {e}")
        return "å›¾ç‰‡åˆ†æå¤±è´¥ã€‚"

# --- ä¸»å‡½æ•° ---
def main():
    with sync_playwright() as p:
        # å¯åŠ¨æµè§ˆå™¨ï¼Œå»ºè®®ä½¿ç”¨ headless=False è¿›è¡Œè°ƒè¯•ï¼Œå¯ä»¥çœ‹åˆ°æµè§ˆå™¨æ“ä½œ
        # å®é™…éƒ¨ç½²æ—¶å¯ä»¥æ”¹ä¸º headless=True
        browser = p.chromium.launch(headless=False, slow_mo=500)
        context = browser.new_context(
            user_agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"
        )
        page = context.new_page()

        try:
            # 1. è¿›å…¥ https://www.xiaohongshu.com/explore
            print("ğŸš€ æ­£åœ¨è®¿é—®å°çº¢ä¹¦æ¢ç´¢é¡µé¢...")
            page.goto("https://www.xiaohongshu.com/explore", wait_until="domcontentloaded")
            
            # ç­‰å¾…é¡µé¢åŠ è½½ä¸€äº›åŸºæœ¬å†…å®¹
            page.wait_for_selector("#exploreFeeds", timeout=30000)
            print("âœ… é¡µé¢åŠ è½½å®Œæˆã€‚")

            # 2. å…³æ‰ç™»å½•å¼¹çª—
            print("ğŸ” æ­£åœ¨æ£€æµ‹ç™»å½•å¼¹çª—...")
            login_popup_close_button = page.locator(".reds-login-modal .close")
            try:
                # ç­‰å¾…å¼¹çª—å‡ºç°ï¼Œå¦‚æœ5ç§’å†…æ²¡å‡ºç°å°±è®¤ä¸ºå®ƒä¸å­˜åœ¨
                login_popup_close_button.wait_for(state="visible", timeout=5000)
                login_popup_close_button.click()
                print("âœ… ç™»å½•å¼¹çª—å·²å…³é—­ã€‚")
            except PlaywrightTimeoutError:
                print("ğŸ’¡ æœªæ£€æµ‹åˆ°ç™»å½•å¼¹çª—ï¼Œæˆ–å¼¹çª—å·²è‡ªåŠ¨æ¶ˆå¤±ï¼Œç»§ç»­æ‰§è¡Œã€‚")

            # 3. è¿›å…¥ç¬¬ä¸€ä¸ªå¸–å­
            print("ğŸ–±ï¸ æ­£åœ¨ç‚¹å‡»ç¬¬ä¸€ä¸ªå¸–å­...")
            first_post_selector = "#exploreFeeds .note-item"
            # ç­‰å¾…å¸–å­å…ƒç´ åŠ è½½å®Œæˆ
            page.wait_for_selector(first_post_selector, state="visible", timeout=20000)
            first_post = page.locator(first_post_selector).first
            first_post.click()
            print("âœ… å·²è¿›å…¥å¸–å­è¯¦æƒ…é¡µã€‚")

            # 4. æ‰’å–å†…å®¹å¡ç‰‡é‡Œçš„ç¬¬ä¸€å¼ å›¾å’Œæ–‡å­—å†…å®¹
            print("ğŸ“ æ­£åœ¨æå–å¸–å­å†…å®¹...")
            
            # ç­‰å¾…å¸–å­è¯¦æƒ…é¡µåŠ è½½å®Œæˆï¼ˆç­‰å¾…æ ‡é¢˜å‡ºç°ï¼‰
            title_selector = "h1.note-title"
            page.wait_for_selector(title_selector, state="visible", timeout=20000)

            # æå–æ–‡å­—å†…å®¹
            title = page.locator(title_selector).inner_text()
            description = page.locator("div.desc").inner_text()
            
            # æå–ç¬¬ä¸€å¼ å›¾
            # å°çº¢ä¹¦çš„å›¾ç‰‡åœ¨è½®æ’­ç»„ä»¶ä¸­ï¼Œå½“å‰æ´»åŠ¨å›¾ç‰‡é€šå¸¸æœ‰ç‰¹æ®Šç±»å
            image_selector = ".swiper-slide-active .canvas-img"
            page.wait_for_selector(image_selector, state="visible", timeout=20000)
            image_element = page.locator(image_selector).first
            
            # å¯¹å›¾ç‰‡å…ƒç´ è¿›è¡Œæˆªå›¾ï¼Œå¾—åˆ°å›¾ç‰‡çš„äºŒè¿›åˆ¶æ•°æ®
            image_bytes = image_element.screenshot()
            print("âœ… å›¾ç‰‡å’Œæ–‡å­—å†…å®¹æå–æˆåŠŸï¼")

            # è°ƒç”¨ Vision API åˆ†æå›¾ç‰‡
            image_description = describe_image_with_gpt4v(image_bytes)

            # --- æ‰“å°ç»“æœ ---
            print("\n" + "="*50)
            print("âœ¨ å°çº¢ä¹¦å¸–å­å†…å®¹æå–ç»“æœ âœ¨")
            print("="*50)
            print(f"ğŸ”— å¸–å­é“¾æ¥: {page.url}")
            print("\n--- ğŸ“ å¸–å­åŸæ–‡ ---\n")
            print(f"æ ‡é¢˜: {title}\n")
            print(f"å†…å®¹:\n{description}")
            print("\n--- ğŸ–¼ï¸ Vision API å›¾ç‰‡è§£è¯» ---\n")
            print(image_description)
            print("\n" + "="*50)

            # æš‚åœï¼Œæ–¹ä¾¿æŸ¥çœ‹ç»“æœ
            print("\nâœ… ä»»åŠ¡å®Œæˆï¼Œæµè§ˆå™¨å°†åœ¨15ç§’åè‡ªåŠ¨å…³é—­...")
            time.sleep(15)

        except Exception as e:
            print(f"\nâŒ æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {e}")
            # å‘ç”Ÿé”™è¯¯æ—¶æˆªå›¾ï¼Œæ–¹ä¾¿è°ƒè¯•
            page.screenshot(path="error_screenshot.png")
            print("å·²ä¿å­˜é”™è¯¯æˆªå›¾åˆ° error_screenshot.png")
            
        finally:
            browser.close()
            print("ğŸ‘‹ æµè§ˆå™¨å·²å…³é—­ã€‚")


if __name__ == "__main__":
    main()
```
# æå‡
- åŠŸèƒ½æ€§ç‘œä¼½ï¼Œè§‰å¾—ä»Šå¤©ä½“åŠ›ä¸€èˆ¬ï¼Œåº”è¯¥æ˜¯æ˜¨å¤©æ²¡ç¡å¥½ï¼Œæ…¢æ…¢æ¥

# å…¶ä»–ï¼š
